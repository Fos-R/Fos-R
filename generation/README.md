# FosR - Generation

Fos-R is a network traffic generator based on AI models. It does not require GPU and can generate in the order of Gbps of network traffic with a laptop.

Several modes are available:

## Pcap-augmentation

In this mode, Fos-R output a pcap file generated with the AI models.

## Honeynet

In this mode, Fos-R generates and play network traffic between different machines in the same network.
Fos-R needs to be executed on these machines and provided a configuration file.

## Replay

In this mode, Fos-R does not generate data but merely replay a pcap through the local interfaces. Provided for convenience.

# Technical details

The generation is split in three stages. Each stage has its own directory.

At the root of the projects, there are some files that describes structures used in several stages. It consist of :
- IP transport layer (TCP, UDP, ICMP);
- various structures in `struct.rs`.

Let us describe the three stages of the generation.

## Stage 1: netflow generation

This step in based on the FlowChronicle tool. Using as input the set of learned patterns,it generates new netflow records by first sampling patterns and then sampling non-fixed values inside these patterns.

It output a list of Flow (defined in `struct.rs`).

## Stage 2: intermediate representation generation

This step is based on the TADAM tool. Using the flows generated by stage 1, it creates a list of PacketsIR<T>, where T is a transport protocol. Each PacketsIR<T> corresponds to a flow between two IP addresses. This structure contains the original flow (generated by stage 1) with the metadata of the flow. There is also a vector packets_info that contains some information about the packet header: packet direction (forward or backward), payload size and type, timestamp, and TCP flags when the transport protocol is TCP.

## Stage 3: packet generation

Stages 3 create a list of complete packets by completing the information given by the output of stage 2.
