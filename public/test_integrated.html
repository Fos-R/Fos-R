<!doctype html>
<html lang="en" class="h-100" data-bs-theme="light">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="generator" content="pandoc">
    <meta name="author" content="Pierre-François Gimenez">
    <meta name="description" content="A network synthetic traffic
generator">
    <title>Fos-R, the synthetic network traffic generator</title>
   
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <!-- Bootstrap Icon -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" integrity="sha384-tViUnnbYAV00FLIhhi3v/dWt3Jxw4gZQcNoSCxCIFNJVCx7/D55/wXsrNIRANwdD" crossorigin="anonymous"> -->
    
    <!-- Highlight.js Styles -->
    <!-- <link rel="stylesheet" id="highlight-style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/stackoverflow-light.min.css"> -->
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="docs.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- After header contents -->
      </head>
  <body class="d-flex flex-column h-100" data-bs-spy="scroll" data-bs-target="#TableOfContents">
    <!-- Before body contents -->
        
    <div class="container-xxl bd-gutter bd-layout mb-5">
      <main class="bd-main order-1">
	
	<!-- Tiltle -->
	<h1 class="bd-intro ps-lg-2 pt-2" id="title">Fos-R, the synthetic
network traffic generator</h1>
	
		<!-- Table of Contents -->
	<div class="bd-toc mt-lg-0 mb-lg-5 mt-3 mb-5 px-sm-1 text-body-secondary">
	  <strong class="d-md-block d-none h6 my-2 ms-3">Table of contents</strong>
	  <hr class="d-md-block d-none my-2 ms-3">
	  <div class="collapse bd-toc-collapse" id="tocContents">
	    <nav id="TableOfContents">
	      <ul>
       <li><a href="#get-fos-r">Get Fos-R</a></li>
       <li><a href="#how-to-use">How to use</a></li>
       <li><a href="#fos-r-other-software">Fos-R &amp; other
       software</a></li>
       <li><a href="#roadmap">Roadmap</a></li>
       <li><a href="#real-world-uses">Real-world uses</a></li>
       <li><a href="#sample-synthetic-data-analysis">Sample synthetic
       data analysis</a></li>
       <li><a href="#related-software">Related software</a></li>
       <li><a href="#related-publications">Related publications</a></li>
       <li><a href="#contributors">Contributors</a></li>
       <li><a href="#licence">Licence</a></li>
       <li><a href="#contact">Contact</a></li>
       </ul>
	    </nav>
	  </div>
	</div>
		
	<!-- Main Content -->
	<div class="bd-content ps-lg-2">
	  <p><img src="logo.png" /></p>
   <p>Fos-R is a network traffic generator based on AI models. It does
   not require a GPU and can generate in the order of Gbps of network
   traffic with a laptop.</p>
   <h1 id="get-fos-r">Get Fos-R</h1>
   <h2 id="cargo-features">Cargo features</h2>
   <p>Fos-R make use of Cargo features for conditional compilation. The
   available features:</p>
   <ul>
   <li><code>iptables</code>: a method for network injection (Linux
   only)</li>
   <li><code>ebpf</code>: a method for network injection (Windows and
   Linux) [default]</li>
   </ul>
   <p>If you do not enable <code>iptables</code> or <code>ebpf</code>,
   Fos-R won’t be able to inject traffic on the network. Generation is
   always available.</p>
   <h2 id="stable-binaries">Stable binaries</h2>
   <p>The binaries of the last stable versions are stored on <a
   href="https://github.com/Fos-R/Fos-R/releases">GitHub</a>.</p>
   <h2 id="experimental-binaries">Experimental binaries</h2>
   <p>Build version 5f14978b, compiled on 2025-11-03.</p>
   <h3 id="linux">Linux</h3>
   <table>
   <colgroup>
   <col style="width: 25%" />
   <col style="width: 19%" />
   <col style="width: 19%" />
   <col style="width: 17%" />
   <col style="width: 19%" />
   </colgroup>
   <thead>
   <tr class="header">
   <th style="text-align: center;">Target</th>
   <th style="text-align: center;">Iptables</th>
   <th style="text-align: center;">eBPF</th>
   <th style="text-align: center;">Binary file</th>
   <th style="text-align: center;">.deb package</th>
   </tr>
   </thead>
   <tbody>
   <tr class="odd">
   <td style="text-align: center;">x86 (32 bits)</td>
   <td style="text-align: center;">✓</td>
   <td style="text-align: center;"></td>
   <td style="text-align: center;"><a
   href="bin/i686-unknown-linux-gnu/release/fosr">link</a></td>
   <td style="text-align: center;"><a
   href="bin/debian/fosr_0.1.2-1_i386.deb">link</a></td>
   </tr>
   <tr class="even">
   <td style="text-align: center;">x86 (64 bits)</td>
   <td style="text-align: center;">✓</td>
   <td style="text-align: center;">✓</td>
   <td style="text-align: center;"><a
   href="bin/x86_64-unknown-linux-gnu/release/fosr">link</a></td>
   <td style="text-align: center;"><a
   href="bin/debian/fosr_0.1.2-1_amd64.deb">link</a></td>
   </tr>
   <tr class="odd">
   <td style="text-align: center;">ARM (32 bits)</td>
   <td style="text-align: center;">✓</td>
   <td style="text-align: center;">✓</td>
   <td style="text-align: center;"><a
   href="bin/arm-unknown-linux-musleabihf/release/fosr">link</a></td>
   <td style="text-align: center;"><a
   href="bin/debian/fosr_0.1.2-1_armhf.deb">link</a></td>
   </tr>
   <tr class="even">
   <td style="text-align: center;">ARM (64 bits)</td>
   <td style="text-align: center;">✓</td>
   <td style="text-align: center;">✓</td>
   <td style="text-align: center;"><a
   href="bin/aarch64-unknown-linux-gnu/release/fosr">link</a></td>
   <td style="text-align: center;"><a
   href="bin/debian/fosr_0.1.2-1_arm64.deb">link</a></td>
   </tr>
   </tbody>
   </table>
   <h3 id="windows">Windows</h3>
   <p>Windows builds can only generate data but cannot inject data into
   the network.</p>
   <table style="width:100%;">
   <colgroup>
   <col style="width: 30%" />
   <col style="width: 23%" />
   <col style="width: 23%" />
   <col style="width: 21%" />
   </colgroup>
   <thead>
   <tr class="header">
   <th style="text-align: center;">Target</th>
   <th style="text-align: center;">Iptables</th>
   <th style="text-align: center;">eBPF</th>
   <th style="text-align: center;">Binary file</th>
   </tr>
   </thead>
   <tbody>
   <tr class="odd">
   <td style="text-align: center;">x86 (64 bits)</td>
   <td style="text-align: center;"></td>
   <td style="text-align: center;"></td>
   <td style="text-align: center;"><a
   href="bin/x86_64-pc-windows-gnu/release/fosr.exe">link</a></td>
   </tr>
   </tbody>
   </table>
   <h2 id="compile-from-source">Compile from source</h2>
   <p>You can also compile Fos-R from source directly. Fos-R is
   distributed with <a
   href="https://crates.io/crates/fosr">crates.io</a>. First, install
   Rust with <a href="https://rustup.rs/">rustup</a>. If you want the
   <code>ebpf</code> features (cf. above), you will need to install a
   few more dependencies:</p>
   <p><code>rustup toolchain install nightly --component rust-src</code></p>
   <p><code>cargo install bpf-linker</code></p>
   <p>Then, you can install the stable version of Fos-R with:</p>
   <p><code>cargo install fosr</code></p>
   <p>Alternatively, you can install the experimental version with:</p>
   <p><code>cargo install --git https://gitlab.inria.fr/pirat-public/Fos-R.git fosr</code></p>
   <p>Once it’s done, you can use Fos-R with the command
   <code>fosr</code>.</p>
   <p>The sources of Fos-R are located on <a
   href="https://gitlab.inria.fr/pirat-public/Fos-R">Inria’s GitLab</a>.
   There is also a <a href="https://github.com/Fos-R/Fos-R">GitHub
   mirror</a>.</p>
   <h2 id="use-as-a-library">Use as a library</h2>
   <p>Fos-R also includes a Rust library that exposes the main parts of
   the software. Its documentation is <a
   href="doc/fosr/index.html">here</a>. You can add the stable version
   of Fos-R to a Rust project with:</p>
   <p><code>cargo add fosr</code></p>
   <p>For the experimental version:</p>
   <p><code>cargo add --git https://gitlab.inria.fr/pirat-public/Fos-R.git fosr</code>.</p>
   <h1 id="how-to-use">How to use</h1>
   <p>Fos-R contains several subcommands.</p>
   <h2 id="pcap-creation">Pcap creation</h2>
   <pre><code>Extend a pcap file. You should use your own models that have been fitted on that pcap file

Usage: fosr create-pcap [OPTIONS] &lt;--duration &lt;DURATION&gt;|--packets-count &lt;PACKETS_COUNT&gt;&gt;

Options:
  -o, --outfile &lt;OUTFILE&gt;              Output pcap file for synthetic network packets [default: output.pcap]
      --taint                          Taint the packets
      --monothread                     Disable multithreading. Use this option if you have a limited number of cores. Must fit the entire dataset in RAM!
  -n, --packets-count &lt;PACKETS_COUNT&gt;  Minimum number of packets to generate. Beware: generation is not deterministic.
  -d, --duration &lt;DURATION&gt;            Minimum pcap traffic duration described in human-friendly time, such as &quot;15days 30min 5s&quot;. Generation is deterministic when used with --order-pcap and --seed.
  -t, --start-time &lt;START_TIME&gt;        Beginning time of the pcap in RFC3339 style (&quot;2025-05-01 10:28:07&quot;) or a Unix timestamp. By default, use current time
      --order-pcap                     Reorder temporally the generated pcap. Must fit the entire dataset in RAM!
  -s, --seed &lt;SEED&gt;                    Seed for random number generation
  -p, --profile &lt;PROFILE&gt;              Path to the profile with the models and the configuration
  -h, --help                           Print help</code></pre>
   <p>If you need a deterministic generation, make sure to specify a
   seed with <code>-s</code>, to set a maximum duration with
   <code>-d</code>, to use <code>--order-pcap</code> and to set a start
   time with <code>-t</code>.</p>
   <p>Example:
   <code>fosr create-pcap -o example.pcap -d 1day --order-pcap</code>.</p>
   <h2 id="network-injection">Network injection</h2>
   <pre><code>This mode requires the `iptables` or `ebpf` feature. In this mode, Fos-R generates and injects network traffic between different computers in the same network. Fos-R needs to be executed on each computer and provided a configuration file

Usage: fosr inject [OPTIONS] --net-enabler &lt;NET_ENABLER&gt;

Options:
  -o, --outfile &lt;OUTFILE&gt;
          Output pcap file of generated packets
      --order-pcap
          Reorder temporally the generated pcap. Must fit the entire dataset in RAM ! Requires --outfile.
  -s, --seed &lt;SEED&gt;
          Seed for random number generation. All participants must use the same seed!
  -f, --flow-per-second &lt;FLOW_PER_SECOND&gt;
          Overall number of flows to generate per second [default: 10]
  -p, --profile &lt;PROFILE&gt;
          Path to the profile with the models and the configuration
  -d, --duration &lt;DURATION&gt;
          Automatically stop the generation after this time. You can use human-friendly time, such as &quot;15days 30min 5s&quot;
  -n, --net-enabler &lt;NET_ENABLER&gt;
          Method to avoid kernel interactions with the injected traffic [possible values: ebpf]
  -a, --injection-algo &lt;INJECTION_ALGO&gt;
          Algorithm for injecting on the wire [default: reliable] [possible values: fast, reliable]
      --deterministic
          Ensure the generated traffic is always the same. It makes Fos-R less robust to staggered process starts, so avoid unless for testing
  -h, --help
          Print help</code></pre>
   <p>Example: <code>fosr inject --net-enabler ebpf</code>.</p>
   <h2 id="pcap2flow">pcap2flow</h2>
   <pre><code>Extract flow statistics from a pcap file to a csv file

Usage: fosr pcap2flow [OPTIONS] --input-pcap &lt;INPUT_PCAP&gt; --output-csv &lt;OUTPUT_CSV&gt;

Options:
  -i, --input-pcap &lt;INPUT_PCAP&gt;  Pcap file to extract flows from
  -o, --output-csv &lt;OUTPUT_CSV&gt;  Csv file to export flow into
  -p, --include-payloads         Include the payloads into the csv file
  -h, --help                     Print help</code></pre>
   <h2 id="untaint-pcap-file">Untaint pcap file</h2>
   <pre><code>Remove the Fos-R taint from a pcap file

Usage: fosr untaint --input &lt;INPUT&gt; --output &lt;OUTPUT&gt;

Options:
  -i, --input &lt;INPUT&gt;    Pcap file to untaint
  -o, --output &lt;OUTPUT&gt;  Pcap file output
  -h, --help             Print help</code></pre>
   <h1 id="fos-r-other-software">Fos-R &amp; other software</h1>
   <p>Feel free to contact us if you would like some help integrating
   Fos-R in your tool!</p>
   <h2 id="wireshark">Wireshark</h2>
   <p>To visualize easily the taint on packets generated by Fos-R on
   Wireshark, right click on any column name &gt;
   <code>Column Preferences...</code> &gt; <code>+</code>. Set the
   fields of the new column as follow:</p>
   <ul>
   <li>Title: <code>Fos-R</code></li>
   <li>Type: <code>Custom</code></li>
   <li>Custom Expression: <code>ip.flags&amp;4&gt;0</code></li>
   <li>Field occurrence: <code>0</code>.</li>
   </ul>
   <p>Finally, consider moving the column up in the columns list.</p>
   <p>Alternatively, you can modify the configuration file of Wireshark
   and add the line <code>"Fos-R", "%Cus:ip.flags&amp;4&gt;0:0:R"</code>
   in the <code>gui.column.format</code> list.</p>
   <h1 id="roadmap">Roadmap</h1>
   <p>Fos-R is currently at v0.1. The following roadmap is indicative.
   Priorities may change over time.</p>
   <h2 id="v1.0---generation">v1.0 - generation</h2>
   <p>Goal: reproducible and evaluated generation</p>
   <ul>
   <li>An enhanced stage 0 with temporal profiles</li>
   <li>A new stage 1 based on Bayesian networks</li>
   <li>An automated and deterministic build and evaluation</li>
   </ul>
   <h2 id="v2.0---portability">v2.0 - portability</h2>
   <p>Goal: a documented Fos-R library, a GUI and more generation
   portability</p>
   <ul>
   <li>A GUI for Fos-R</li>
   <li>Cross-compilation (generation only) for most platforms (Linux,
   Windows, macOS, BSD)</li>
   <li>A WASM version for in-browser generation</li>
   <li>A well-documented library</li>
   </ul>
   <h2 id="v3.0---net-injection">v3.0 - net injection</h2>
   <p>Goal: High-throughput network injection</p>
   <ul>
   <li>A new network enabler for reliable and high-throughput network
   injection</li>
   <li>Injection mode on Windows</li>
   <li>New injection modes</li>
   </ul>
   <h1 id="real-world-uses">Real-world uses</h1>
   <h2 id="breizhctf-2025">BreizhCTF 2025</h2>
   <p>Fos-R created background network traffic for the <a
   href="https://gitlab.inria.fr/pirat-public/pirhack/pirhack">Pirhack</a>
   challenge during the <a href="https://www.breizhctf.com/">BreizhCTF
   2025</a> hacking competition for about 600 participants. During that
   competition, Fos-R was deployed on 750 virtual machines for a total
   of 23,000 cumulated hours.</p>
   <h2 id="education">Education</h2>
   <p>Fos-R was also used for smaller CTF competitions used for
   education, such as <a
   href="https://anr.fr/ProjetIA-23-CMAS-0014">TCE</a> CTF and <a
   href="https://ressi2025.sciencesconf.org/resource/page/id/15">RESSI
   CTF</a>.</p>
   <h1 id="sample-synthetic-data-analysis">Sample synthetic data
   analysis</h1>
   <p>Download <strong><a href="./sample.pcap">here</a></strong> the
   sample data that has been generated by Fos-R with the following
   command line:
   <code>fosr create-pcap -o sample.pcap -s 0 -d 1min -t 0</code>. All
   the analyses pertain to this pcap file. They have been automatically
   computed by the CI pipeline to ensure reproducibility.</p>
   <ul>
   <li><a href="./analysis-zeek.zip">Zeek analysis</a></li>
   <li><a href="./analysis-suricata.zip">Suricata analysis</a></li>
   <li><a href="./analysis-tshark.zip">TShark analysis</a></li>
   </ul>
   <h1 id="related-software">Related software</h1>
   <p>The following software have been created for Fos-R:</p>
   <ul>
   <li><a href="https://github.com/Fos-R/TADAM">TADAM</a>, an automata
   learner</li>
   <li><a
   href="https://github.com/Fos-R/FlowChronicle">FlowChronicle</a>, a
   pattern miner</li>
   </ul>
   <h1 id="related-publications">Related publications</h1>
   <h2
   id="synthetic-network-traffic-generation-for-intrusion-detection-systems-a-systematic-literature-review">Synthetic
   Network Traffic Generation for Intrusion Detection Systems: a
   Systematic Literature Review</h2>
   <p><em>Published in ESORICS 2025 International Workshops,
   2025</em></p>
   <p>Authors: Pierre-François Gimenez</p>
   <p>Network data can be difficult to collect due to privacy and
   confidentiality reasons. For these reasons, network datasets are
   typically created with controlled environments called testbeds.
   However, these datasets are regularly criticized for their limited
   size, class imbalance, obsolescence, and lack of actual user
   activity. Following the rapid development of generative artificial
   intelligence, new methods have been applied to synthetic network
   traffic generation without emulation or simulation. This systematic
   literature review assesses the current state of synthetic network
   traffic generation for intrusion detection systems.</p>
   <h2 id="tadam-learning-timed-automata-from-noisy-observations">TADAM:
   Learning Timed Automata From Noisy Observations</h2>
   <p><em>Published in SIAM International Conference on Data Mining
   (SDM25), 2025</em></p>
   <p>Authors: Lénaïg Cornanguer, Pierre-François Gimenez</p>
   <p>Timed Automata (TA) are formal models capable of representing
   regular languages with timing constraints, making them well-suited
   for modeling systems where behavior is driven by events occurring
   over time. Most existing work on TA learning relies on active
   learning, where access to a teacher is assumed to answer membership
   queries and provide counterexamples. While this framework offers
   strong theoretical guarantees, it is impractical for many real-world
   applications where such a teacher is unavailable. In contrast,
   passive learning approaches aim to infer TA solely from sequences
   accepted by the target automaton. However, current methods struggle
   to handle noise in the data, such as symbol omissions, insertions, or
   permutations, which often result in excessively large and inaccurate
   automata. In this paper, we introduce TADAM, a novel approach that
   leverages the Minimum Description Length (MDL) principle to balance
   model complexity and data fit, allowing it to distinguish between
   meaningful patterns and noise. We show that TADAM is significantly
   more robust to noisy data than existing techniques, less prone to
   overfitting, and produces concise models that can be manually
   audited. We further demonstrate its practical utility through
   experiments on real-world tasks, such as network flow classification
   and anomaly detection.</p>
   <h2
   id="flowchronicle-synthetic-network-flow-generation-through-pattern-set-mining">FlowChronicle:
   Synthetic Network Flow Generation through Pattern Set Mining</h2>
   <p><em>Published in 20th International Conference on emerging
   Networking EXperiments and Technologies (CoNEXT), 2024</em></p>
   <p>Authors: Joscha Cüppers, Adrien Schoen, Gregory Blanc,
   Pierre-Francois Gimenez</p>
   <p>Network traffic datasets are regularly criticized, notably for the
   lack of realism and diversity in their attack or benign traffic.
   Generating synthetic network traffic using generative machine
   learning techniques is a recent area of research that could
   complement experimental test beds and help assess the efficiency of
   network security tools such as network intrusion detection systems.
   Most methods generating synthetic network flows disregard the
   temporal dependencies between them, leading to unrealistic traffic.
   To address this issue, we introduce FlowChronicle, a novel synthetic
   network flow generation tool that relies on pattern mining and
   statistical models to preserve temporal dependencies. We empirically
   compare our method against state-of-the-art techniques on several
   criteria, namely realism, diversity, compliance, and novelty. This
   evaluation demonstrates the capability of FlowChronicle to achieve
   high-quality generation while significantly outperforming the other
   methods in preserving temporal dependencies between flows. Besides,
   in contrast to deep learning methods, the patterns identified by
   FlowChronicle are explainable, and experts can verify their
   soundness. Our work substantially advances synthetic network traffic
   generation, offering a method that enhances both the utility and
   trustworthiness of the generated network flows.</p>
   <h2
   id="a-tale-of-two-methods-unveiling-the-limitations-of-gan-and-the-rise-of-bayesian-networks-for-synthetic-network-traffic-generation">A
   Tale of Two Methods: Unveiling the limitations of GAN and the Rise of
   Bayesian Networks for Synthetic Network Traffic Generation</h2>
   <p><em>Published in 9th International Workshop on Traffic
   Measurements for Cybersecurity (WTMC 2024), 2024</em></p>
   <p>Authors: Adrien Schoen, Gregory Blanc, Pierre-François Gimenez,
   Yufei Han, Frédéric Majorczyk, Ludovic Mé</p>
   <p>The evaluation of network intrusion detection systems requires a
   sufficient amount of mixed network traffic, i.e., composed of both
   malicious and legitimate flows. In particular, obtaining realistic
   legitimate traffic is hard. Synthetic network traffic is one of the
   tools to respond to insufficient or incomplete real-world datasets.
   In this paper, we only focus on synthetically generating high-quality
   legitimate traffic and we do not delve into malicious traffic
   generation. For this specific task, recent contributions make use of
   advanced machine learning-driven approaches, notably through
   Generative Adversarial Networks (GANs). However, evaluations of
   GAN-generated data often disregards pivotal attributes, such as
   protocol adherence. Our study addresses the gap by proposing a
   comprehensive set of metrics that assess the quality of synthetic
   legitimate network traffic. To illustrate the value of these metrics,
   we empirically compare advanced network-oriented GANs with a simple
   and yet effective probabilistic generative model, Bayesian Networks
   (BN). According to our proposed evaluation metrics, BN-based network
   traffic generation outperforms the state-of-the-art GAN-based
   opponents. In our study, BN yields substantially more realistic and
   useful synthetic benign traffic and minimizes the computational costs
   simultaneously.</p>
   <h1 id="contributors">Contributors</h1>
   <h2 id="scientific-contributors">Scientific contributors</h2>
   <ul>
   <li>Inria: Pierre-François Gimenez, Yufei Han, Ludovic Mé, Adrien
   Schoen</li>
   <li>CISPA: Lénaïg Cornanguer, Joscha Cüppers</li>
   <li>Télécom SudParis: Grégory Blanc</li>
   <li>DGA: Frédéric Majorczyk</li>
   </ul>
   <h2 id="software-contributors">Software contributors</h2>
   <ul>
   <li>Inria: Pierre-François Gimenez, Adrien Schoen</li>
   <li>CISPA: Lénaïg Cornanguer, Joscha Cüppers</li>
   <li>CentraleSupélec: Dorian Bachelot, Evan Morin, Florentin Labelle,
   Samuel Cordon, Jean-Baptiste Amade</li>
   </ul>
   <h1 id="licence">Licence</h1>
   <p>Fos-R is distributed under the <a
   href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPLv3</a> (or
   later) license. This applies to both Fos-R binary and library.</p>
   <h1 id="contact">Contact</h1>
   <p>You can contact the maintainer at <a
   href="mailto:pierre-francois.gimenez@inria.fr"
   class="email">pierre-francois.gimenez@inria.fr</a>. Feel free to post
   an issue on <a
   href="https://github.com/Fos-R/Fos-R/issues">GitHub</a>.</p>

    <!-- Start of WASM GUI Integration -->
    <h1 id="fosr-wasm-gui">Fos-R Wasm GUI (Experimental Demo)</h1>

    <div id="gui_wrapper">
        <div id="gui_loading_text">Loading Application...</div>
        <canvas id="fosr_gui_canvas" class="gui_canvas"></canvas>
    </div>
    <!-- End of WASM GUI Integration -->
	</div>
      </main>
    </div>
    
    <!-- After body contents -->
        <!-- Add comment hosting service here (optional) -->

        <!-- Footer -->
        <footer class="footer bd-footer bg-body-tertiary mt-auto py-md-3 py-4">
          <div class="container text-body-secondary py-md-3 py-4" align="center">
            <!-- Update licences -->
            Content is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener">CC BY-SA 4.0</a>
            &nbsp;|&nbsp;
            Source code is licensed under <a href="https://www.gnu.org/licenses/gpl-3.0.en.html" target="_blank" rel="noopener">GPL-3.0</a>
            <br />
            <!-- Please keep the following line -->
            Built by <a href="https://github.com/ashki23/pandoc-bootstrap" target="_blank" rel="noopener">pandoc-bootstrap</a> theme
            <br />
            <!-- Update copyright -->
          </div>
        </footer>

        <!-- Add global site tag (gtag.js) and site analytics here (optional) -->

    <!-- Bootstrap Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    
    <!-- Highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/highlight.min.js" integrity="sha512-6yoqbrcLAHDWAdQmiRlHG4+m0g/CT/V9AGyxabG8j7Jk8j3r3K6due7oqpiRMZqcYe9WM2gPcaNNxnl2ux+3tA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
        <!-- Mathjax -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
    <!-- Custom Scripts -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {
	  const htmlElement = document.documentElement;
	  const highlightStyle = document.getElementById("highlight-style");
	  
	  // Function to update Highlight.js style based on theme
	  const updateHighlightStyle = (theme) => {
              const lightTheme = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/stackoverflow-light.min.css";
              const darkTheme = "https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.10.0/styles/github-dark.min.css";
              highlightStyle.href = theme === "dark" ? darkTheme : lightTheme;
	  };
	  
	  // Function to set the theme
	  const setTheme = (theme) => {
              htmlElement.setAttribute("data-bs-theme", theme);
              localStorage.setItem("theme", theme); // Save the theme to localStorage
              updateHighlightStyle(theme);
	  };
	  
	  // Get saved theme from localStorage or fallback to default ("light")
	  const savedTheme = localStorage.getItem("theme") || "dark";
	  setTheme(savedTheme);
	  
	  // Event listener for theme dropdown
	  document.querySelectorAll(".dropdown-item").forEach((item) => {
              item.addEventListener("click", (e) => {
		  e.preventDefault();
		  const selectedTheme = item.getAttribute("data-theme");
		  setTheme(selectedTheme);
              });
	  });

	  // Initialize Highlight.js
	  hljs.highlightAll();
      });
    </script>

    <!-- Script to load the WASM application -->
    <script type="module">
        // Import the WASM initializer and start function.
        import init, { start } from './fosr_gui.js';

        async function run() {
            // 1. Initialize the WASM module
            await init();

            // 2. Start the application, passing the canvas ID
            await start('fosr_gui_canvas');

            // 3. Remove the loading text once initialization is complete
            const loadingText = document.getElementById('gui_loading_text');
            if (loadingText) {
                loadingText.remove();
            }
        }

        run().catch(error => {
            console.error('Failed to start WASM application:', error);
            // Update the loading text to show an error message
            const loadingText = document.getElementById('gui_loading_text');
            if (loadingText) {
                loadingText.innerHTML = '<p style="color: red;">Application failed to load. Check console for details.</p>';
            }
        });
    </script>
  </body>
</html>
